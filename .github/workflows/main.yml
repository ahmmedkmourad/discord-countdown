name: Countdown Bot

on:
  schedule:
    - cron: '0 9 * * *'
  workflow_dispatch:

jobs:
  bot:
    runs-on: ubuntu-latest
    steps:
    - name: Install Python
      run: |
        python3 -m pip install requests
        
    - name: Run countdown script
      env:
        WEBHOOK_URL: ${{ secrets.WEBHOOK_URL }}
      run: |
        python3 << 'EOF'
import requests, os
from datetime import datetime

url = os.getenv('WEBHOOK_URL')
now = datetime.now()
year = now.year

# Calculate target date
target = datetime(year, 4, 1, 18, 20, 0)
if now > target:
    target = datetime(year + 1, 4, 1, 18, 20, 0)

# Calculate time left
diff = target - now
days = diff.days
hours = diff.seconds // 3600

# Create message
msg = f"ðŸ“… **Daily Countdown:** {days} days, {hours} hours until April 1st, {target.year} at 18:20"

# Send to Discord
requests.post(url, json={"content": msg, "username": "Countdown Bot"})
print(f"Sent: {days} days remaining")
EOF
