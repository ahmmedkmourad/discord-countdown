name: Simple Countdown
on:
  workflow_dispatch:
  schedule:
    - cron: '0 9 * * *'
jobs:
  send:
    runs-on: ubuntu-latest
    steps:
      - name: Send countdown
        env:
          WEBHOOK_URL: ${{ secrets.WEBHOOK_URL }}
        run: |
          # Get current date in seconds
          NOW=$(date +%s)
          
          # Get target date (April 1st current year)
          YEAR=$(date +%Y)
          TARGET=$(date -d "${YEAR}-04-01 18:20:00" +%s)
          
          # If past April 1st, use next year
          if [ $NOW -gt $TARGET ]; then
            YEAR=$((YEAR + 1))
            TARGET=$(date -d "${YEAR}-04-01 18:20:00" +%s)
          fi
          
          # Calculate days
          SECONDS=$((TARGET - NOW))
          DAYS=$((SECONDS / 86400))
          HOURS=$(((SECONDS % 86400) / 3600))
          
          # Send to Discord
          curl -X POST \
            -H "Content-Type: application/json" \
            -d "{\"content\": \"ðŸ“… **Daily Countdown:** ${DAYS} days, ${HOURS} hours until April 1st, ${YEAR} at 18:20\", \"username\": \"Countdown Bot\"}" \
            "$WEBHOOK_URL"
          
          echo "âœ… Sent countdown"
